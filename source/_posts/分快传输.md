
---
title: 分块传输
date: 2019-3-23 10:43:52
tags:
    - 过Waf
    - 分块传输
    - 插件
categories: [学习笔记]
---

## 前言

分块传输编码（Chunked transfer encoding）是超文本传输协议（HTTP）中的一种数据传输机制，允许HTTP由网页服务器发送给客户端应用（ 通常是网页浏览器）的数据可以分成多个部分。分块传输编码只在HTTP协议1.1版本（HTTP/1.1）中提供。
通常，HTTP应答消息中发送的数据是整个发送的，Content-Length消息头字段表示数据的长度。

<!-- more -->

数据的长度很重要，因为客户端需要知道哪里是应答消息的结束，以及后续应答消息的开始。然而，使用分块传输编码，数据分解成一系列数据块，并以一个或多个块发送，这样服务器可以发送数据而不需要预先知道发送内容的总大小。通常数据块的大小是一致的，但也不总是这种情况。




## Transfer-Encoding 分块传输

**如果存在Transfer-Encoding（重点是chunked），则在header中不能有Content-Length，有也会被忽视。每个块以16进制数值表示当前块的数据大小，然后\r\n；再然后是当前chunk的数据内容，接着是\r\n；结束块（终止块）是一个常规块，但长度为零。当读取到chunk 的数据大小是0时，意味着请求或响应数据已经分块传输完毕。**

例子：

```
HTTP/1.1 200 OK 
Content-Type: text/plain 
Transfer-Encoding: chunked

7\r\n       大小：7字节
Mozilla\r\n    chunk内容

9\r\n       大小：9字节
Developer\r\n   chunk内容

7\r\n       大小：7字节
Network\r\n    chunk内容

0\r\n       结束块，0字节
\r\n
```


## 利用分块传输吊打所有WAF

[利用分块传输吊打所有WAF](https://www.anquanke.com/post/id/169738 "利用分块传输吊打所有WAF")


## Burp suite 分块传输辅助插件

https://github.com/c0ny1/chunked-coding-converter

### 插件编译
`mvn package`

### 插件使用

![avatar](https://github.com/c0ny1/chunked-coding-converter/raw/master/doc/menu.png
)

![avatar](https://github.com/c0ny1/chunked-coding-converter/raw/master/doc/config.png
)

## 参考链接

1.https://zh.wikipedia.org/wiki/%E5%88%86%E5%9D%97%E4%BC%A0%E8%BE%93%E7%BC%96%E7%A0%81

2.https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Transfer-Encoding